# Microservices Architecture Diagram

## System Overview

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    CLIENT APPLICATIONS                                                  │
│                                                                                                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                  │
│  │   Web App   │  │ Mobile App  │  │ Third-party │  │   Desktop   │  │   IoT       │                  │
│  │             │  │             │  │    APIs     │  │    App      │  │  Devices    │                  │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘                  │
└─────────────────────────────────┬─────────────────────────────────────────────────────────────────────┘
                                  │ HTTP/HTTPS Requests
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                      KONG GATEWAY                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              API GATEWAY LAYER                                                 │   │
│  │                                                                                                 │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐               │   │
│  │  │   JWT Auth  │ │Rate Limiting│ │   Routing   │ │   Logging   │ │   CORS      │               │   │
│  │  │             │ │             │ │             │ │             │ │             │               │   │
│  │  │ • Validate  │ │ • 100 req/min│ │ • Path-based│ │ • Access    │ │ • Cross-    │               │   │
│  │  │   tokens    │ │ • Per client │ │   routing   │ │   logs      │ │   origin    │               │   │
│  │  │ • Claims    │ │ • Headers    │ │ • Load bal. │ │ • Error logs│ │   support   │               │   │
│  │  │   check     │ │ • Blocking   │ │ • Health    │ │ • Metrics   │ │ • Security  │               │   │
│  │  │   check     │ │ • Blocking   │ │ • Health    │ │ • Metrics   │ │ • Security  │               │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘               │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                         │
│  Port: 8000 (HTTP) / 8443 (HTTPS)                                                                       │
│  Admin: 8001 (HTTP) / 8444 (HTTPS)                                                                      │
└─────────────────────────────────┬─────────────────────────────────────────────────────────────────────┘
                                  │ Internal Docker Network
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    MICROSERVICES LAYER                                                  │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              BUSINESS SERVICES                                                     │   │
│  │                                                                                                 │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐               │   │
│  │  │   CUSTOMER  │ │    ORDER    │ │   PAYMENT   │ │    CHAT     │ │    FILE     │               │   │
│  │  │   Service   │ │   Service   │ │   Service   │ │   Service   │ │   Service   │               │   │
│  │  │   Port:3002 │ │   Port:3003 │ │   Port:3004 │ │   Port:3005 │ │   Port:3006 │               │   │
│  │  │             │ │             │ │             │ │             │ │             │               │   │
│  │  │ • Register  │ │ • Get Order │ │ • Process   │ │ • Messages  │ │ • Upload    │               │   │
│  │  │ • Login     │ │ • List      │ │   Payment   │ │ • Real-time │ │ • Download  │               │   │
│  │  │ • JWT Gen   │ │ • Protected │ │ • Protected │ │   Chat      │ │ • Storage   │               │   │
│  │  │ • Auth      │ │ • CRUD      │ │ • Gateway   │ │ • WebSocket │ │ • Validation│               │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘               │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              INFRASTRUCTURE SERVICES                                               │   │
│  │                                                                                                 │   │
│  │  ┌─────────────┐                                                                               │   │
│  │  │    CACHE    │                                                                               │   │
│  │  │   Service   │                                                                               │   │
│  │  │   Port:3001 │                                                                               │   │
│  │  │             │                                                                               │   │
│  │  │ • Redis     │                                                                               │   │
│  │  │ • Key-Value │                                                                               │   │
│  │  │ • Caching   │                                                                               │   │
│  │  │ • Sessions  │                                                                               │   │
│  │  └─────────────┘                                                                               │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────┬─────────────────────────────────────────────────────────────────────┘
                                  │ Database Connections
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                      DATA LAYER                                                        │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              DATABASES                                                             │   │
│  │                                                                                                 │   │
│  │  ┌─────────────────────────────────────────────────┐ ┌─────────────────────────────────────┐   │   │
│  │  │                   MONGODB                       │ │               REDIS                 │   │   │
│  │  │                 Port: 27017                     │ │             Port: 6379              │   │   │
│  │  │                                                 │ │                                       │   │   │
│  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐│ │  ┌─────────────┐ ┌─────────────┐   │   │   │
│  │  │  │   Users     │ │   Orders    │ │   Payments  ││ │  │   Sessions  │ │   Cache     │   │   │   │
│  │  │  │             │ │             │ │             ││ │  │             │ │             │   │   │   │
│  │  │  │ • username  │ │ • orderId   │ │ • amount    ││ │  │ • sessionId │ • key-value  │   │   │   │
│  │  │  │ • password  │ │ • status    │ │ • currency  ││ │  │ • userId    │ • TTL        │   │   │   │
│  │  │  │ • email     │ │ • customer  │ │ • method    ││ │  │ • data      │ • expiration │   │   │   │
│  │  │  │ • created   │ │ • items     │ │ • status    ││ │  │ • expires   │ • persistence│   │   │   │
│  │  │  └─────────────┘ └─────────────┘ └─────────────┘│ │  └─────────────┘ └─────────────┘   │   │
│  │  └─────────────────────────────────────────────────┘ └─────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## Authentication Flow Diagram

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Client    │    │    Kong     │    │  Customer   │    │  MongoDB    │    │   Response  │
│             │    │  Gateway    │    │  Service    │    │             │    │             │
└──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘
       │                  │                  │                  │                  │
       │ 1. POST /login   │                  │                  │                  │
       │ ────────────────▶│                  │                  │                  │
       │                  │                  │                  │                  │
       │                  │                  │ 2. Route to      │                  │
       │                  │                  │ customer service │                  │
       │                  │ ────────────────▶│                  │                  │
       │                  │                  │                  │                  │
       │                  │                  │ 3. Validate user │                  │
       │                  │                  │ ────────────────▶│                  │
       │                  │                  │                  │                  │
       │                  │                  │ 4. User data     │                  │
       │                  │                  │ ◀────────────────│                  │
       │                  │                  │                  │                  │
       │                  │ 5. Generate JWT  │                  │                  │
       │                  │ ◀────────────────│                  │                  │
       │                  │                  │                  │                  │
       │ 6. JWT Token     │                  │                  │                  │
       │ ◀────────────────│                  │                  │                  │
       │                  │                  │                  │                  │
       │ 7. API Request   │                  │                  │                  │
       │ + JWT Token      │                  │                  │                  │
       │ ────────────────▶│                  │                  │                  │
       │                  │                  │                  │                  │
       │                  │ 8. Validate JWT  │                  │                  │
       │                  │ ────────────────▶│                  │                  │
       │                  │                  │                  │                  │
       │                  │ 9. Route to      │                  │                  │
       │                  │ target service   │                  │                  │
       │                  │ ────────────────▶│                  │                  │
       │                  │                  │                  │                  │
       │                  │                  │ 10. Process      │                  │
       │                  │                  │ request          │                  │
       │                  │                  │ ────────────────▶│                  │
       │                  │                  │                  │                  │
       │                  │                  │ 11. Response     │                  │
       │                  │                  │ ◀────────────────│                  │
       │                  │                  │                  │                  │
       │                  │ 12. Forward      │                  │                  │
       │                  │ response         │                  │                  │
       │                  │ ◀────────────────│                  │                  │
       │                  │                  │                  │                  │
       │ 13. API Response │                  │                  │                  │
       │ ◀────────────────│                  │                  │                  │
       │                  │                  │                  │                  │
```

## Service Communication Flow

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Client    │    │    Kong     │    │ Microservice│    │  Database   │
│             │    │  Gateway    │    │             │    │             │
└──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘
       │                  │                  │                  │
       │ HTTP Request     │                  │                  │
       │ ────────────────▶│                  │                  │
       │                  │                  │                  │
       │                  │ 1. JWT Validation│                  │
       │                  │ 2. Rate Limiting │                  │
       │                  │ 3. Route Request │                  │
       │                  │ ────────────────▶│                  │
       │                  │                  │                  │
       │                  │                  │ 4. Process       │
       │                  │                  │ Business Logic   │
       │                  │                  │ ────────────────▶│
       │                  │                  │                  │
       │                  │                  │ 5. Database      │
       │                  │                  │ Response         │
       │                  │                  │ ◀────────────────│
       │                  │                  │                  │
       │                  │ 6. Service       │                  │
       │                  │ Response         │                  │
       │                  │ ◀────────────────│                  │
       │                  │                  │                  │
       │ 7. HTTP Response │                  │                  │
       │ ◀────────────────│                  │                  │
       │                  │                  │                  │
```

## Security Layers

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    SECURITY LAYERS                                                      │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              LAYER 1: NETWORK SECURITY                                             │   │
│  │                                                                                                 │   │
│  │  • Docker Network Isolation                                                                     │   │
│  │  • Internal Service Communication                                                               │   │
│  │  • Port Exposure Control                                                                        │   │
│  │  • Firewall Rules                                                                               │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              LAYER 2: API GATEWAY SECURITY                                         │   │
│  │                                                                                                 │   │
│  │  • JWT Token Validation                                                                         │   │
│  │  • Rate Limiting (100 req/min)                                                                  │   │
│  │  • Request Routing & Validation                                                                 │   │
│  │  • CORS Protection                                                                              │   │
│  │  • Request/Response Logging                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              LAYER 3: SERVICE SECURITY                                             │   │
│  │                                                                                                 │   │
│  │  • Password Hashing (bcrypt)                                                                    │   │
│  │  • Input Validation & Sanitization                                                              │   │
│  │  • Error Handling                                                                               │   │
│  │  • Service Isolation                                                                            │   │
│  │  • Authentication Required                                                                      │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              LAYER 4: DATA SECURITY                                                │   │
│  │                                                                                                 │   │
│  │  • Database Access Control                                                                      │   │
│  │  • Data Encryption                                                                              │   │
│  │  • Connection Security                                                                          │   │
│  │  • Backup & Recovery                                                                            │   │
│  │  • Audit Logging                                                                                │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    DOCKER CONTAINERS                                                    │
│                                                                                                         │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐     │
│  │     Kong    │ │   Customer  │ │    Order    │ │   Payment   │ │    Chat     │ │    File     │     │
│  │  Gateway    │ │   Service   │ │   Service   │ │   Service   │ │   Service   │ │   Service   │     │
│  │             │ │             │ │             │ │             │ │             │ │             │     │
│  │ • Port 8000 │ │ • Port 3002 │ │ • Port 3003 │ │ • Port 3004 │ │ • Port 3005 │ │ • Port 3006 │     │
│  │ • JWT Auth  │ │ • MongoDB   │ │ • Protected │ │ • Protected │ │ • WebSocket │ │ • File I/O  │     │
│  │ • Rate Limit│ │ • Register  │ │ • CRUD      │ │ • Gateway   │ │ • Real-time │ │ • Validation│     │
│  │ • Routing   │ │ • Login     │ │ • Orders    │ │ • Payments  │ │ • Messages  │ │ • Storage   │     │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘     │
│                                                                                                         │
│  ┌─────────────┐ ┌─────────────┐                                                                       │
│  │    Cache    │ │   MongoDB   │                                                                       │
│  │   Service   │ │  Database   │                                                                       │
│  │             │ │             │                                                                       │
│  │ • Port 3001 │ │ • Port 27017│                                                                       │
│  │ • Redis     │ │ • Users     │                                                                       │
│  │ • Sessions  │ │ • Orders    │                                                                       │
│  │ • Caching   │ │ • Payments  │                                                                       │
│  └─────────────┘ └─────────────┘                                                                       │
│                                                                                                         │
│  ┌─────────────┐                                                                                       │
│  │    Redis    │                                                                                       │
│  │   Cache     │                                                                                       │
│  │             │                                                                                       │
│  │ • Port 6379 │                                                                                       │
│  │ • Sessions  │                                                                                       │
│  │ • Cache     │                                                                                       │
│  │ • Rate Limit│                                                                                       │
│  └─────────────┘                                                                                       │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## Scalability Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    SCALABILITY PATTERNS                                                 │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              HORIZONTAL SCALING                                                     │   │
│  │                                                                                                 │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐               │   │
│  │  │   Kong 1    │ │   Kong 2    │ │   Kong 3    │ │   Kong 4    │ │   Kong N    │               │   │
│  │  │             │ │             │ │             │ │             │ │             │               │   │
│  │  │ Load Balancer│ │ Load Balancer│ │ Load Balancer│ │ Load Balancer│ │ Load Balancer│               │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘               │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              SERVICE SCALING                                                       │   │
│  │                                                                                                 │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐               │   │
│  │  │ Customer 1  │ │ Customer 2  │ │ Customer 3  │ │ Customer 4  │ │ Customer N  │               │   │
│  │  │             │ │             │ │             │ │             │ │             │               │   │
│  │  │ • Register  │ │ • Register  │ │ • Register  │ │ • Register  │ │ • Register  │               │   │
│  │  │ • Login     │ │ • Login     │ │ • Login     │ │ • Login     │ │ • Login     │               │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘               │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                              DATABASE SCALING                                                      │   │
│  │                                                                                                 │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐               │   │
│  │  │ MongoDB 1   │ │ MongoDB 2   │ │ MongoDB 3   │ │ Redis 1     │ │ Redis 2     │               │   │
│  │  │             │ │             │ │             │ │             │ │             │               │   │
│  │  │ • Primary   │ │ • Secondary │ │ • Secondary │ │ • Master    │ │ • Slave     │               │   │
│  │  │ • Write     │ │ • Read      │ │ • Read      │ │ • Write     │ │ • Read      │               │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘               │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘
``` 